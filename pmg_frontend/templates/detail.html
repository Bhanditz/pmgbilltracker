{% extends "base.html" %}
{% block title %}{{ bill.name }}{% endblock %}
{% block page %}

    <h1>{{ bill.name }}</h1>

    <p class="lead">{{ bill.objective }}</p>
    <p class="pull-right">{{ bill.bill_type }}</p>
    <p class="label label-info bill-status">{{ bill.status }}</p>
    <hr>

    {% if bill.events | length > 0 %}
        {% set prev_location = bill.events[0].stage.location.location_id %}

        {% for event in bill.events %}
            {% if loop.first or event.stage.location.location_id != prev_location %}
                {% if not loop.first %}
                    </div>
                {% endif %}
                <div class="container location location-{{ event.stage.location.location_id }}">
                <div class="location-title location-{{ event.stage.location.location_id }}">Level: {{ event.stage.location.name }}</div>
                {% set prev_location = event.stage.location.location_id %}
            {% else %}
                {% if not loop.first %}
                    <hr>
                {% endif %}
            {% endif %}

        <div class="row">
            <div class="col-md-12">
                <p class="pull-right">{{ event.date }}</p>
                <p class="text-muted">Stage: {{ event.stage.name }}</p>
                {% if event.new_status %}
                    <p>{{ event.new_status }}</p>
                {% endif %}

                <p>{{ event.agent.name }}</p>

                {% if event.content | length > 0 %}
                    <ul>
                        {% for item in event.content %}

                            <li>{{ item.title }} <a href="{{ item.url }}"><span class="glyphicon glyphicon-chevron-right"> </span> more</a></li>
                            {#                            {% if item.description %}#}
                            {#                                <p><em>{{ item.description }}</em></p>#}
                            {#                            {% endif %}#}
                        {% endfor %}
                    </ul>
                {% endif %}
            </div>
            {#            <div class="col-md-3"></div>#}
        </div>
        {% if loop.last %}
            </div>
        {% endif %}
        {% endfor %}
    {% else %}
        <p class="lead text-muted">There are no events to display.</p>
    {% endif %}

{% endblock page %}